<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Création des Questions</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1 id="exam-title"></h1>
  <p id="exam-info"></p>

  <form id="questions-form"></form>

  <button onclick="generateJSON()">Générer l'examen</button>

  <pre id="result-json" style="background: #f0f0f0; padding: 15px; white-space: pre-wrap; margin-top: 20px;"></pre>

  <script>
    const name = localStorage.getItem("examName");
    const nbQuestions = parseInt(localStorage.getItem("nbQuestions"));
    const duration = localStorage.getItem("duration");

    document.getElementById("exam-title").textContent = `Examen : ${name}`;
    document.getElementById("exam-info").textContent = `Durée : ${duration} min | Nombre de questions : ${nbQuestions}`;

    const form = document.getElementById("questions-form");

    for (let i = 0; i < nbQuestions; i++) {
      const qDiv = document.createElement("div");
      qDiv.className = "form-section";

      qDiv.innerHTML = `
        <h3>Question ${i + 1}</h3>
        <label>Type :</label>
        <select name="type-${i}" onchange="toggleOptions(this, ${i})">
          <option value="qcm">QCM</option>
          <option value="open">Réponse ouverte</option>
        </select>

        <input type="text" name="text-${i}" placeholder="Texte de la question" required>

        <div class="options" id="options-${i}">
          <input type="text" name="opt1-${i}" placeholder="Option 1">
          <input type="text" name="opt2-${i}" placeholder="Option 2">
          <input type="text" name="opt3-${i}" placeholder="Option 3">
          <input type="text" name="opt4-${i}" placeholder="Option 4">
        </div>

        <div class="open-settings" id="open-${i}" style="display:none;">
          <input type="text" name="open-answer-${i}" placeholder="Réponse attendue">
          <input type="number" name="penalty-${i}" placeholder="Réduction de points (optionnel)">
        </div>

        <input type="number" name="points-${i}" placeholder="Points" required>
      `;
      form.appendChild(qDiv);
    }

    function toggleOptions(select, index) {
      const optDiv = document.getElementById(`options-${index}`);
      const openDiv = document.getElementById(`open-${index}`);
      if (select.value === "qcm") {
        optDiv.style.display = "block";
        openDiv.style.display = "none";
      } else {
        optDiv.style.display = "none";
        openDiv.style.display = "block";
      }
    }
  </script>

  <script src="exam-backend.js"></script>
</body>
</html>
